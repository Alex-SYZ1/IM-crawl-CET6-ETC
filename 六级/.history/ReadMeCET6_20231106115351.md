## [四六级网站](https://pan.uvooc.com/)内容爬取并半自动化分类（可应用于本网站其他资源，除部分非免费开放资源）

### 一、目录文件
```
./CET6真题及答案/:  
以年份为文件夹，每文件夹下为真题、解析或真题及解析文件  
A开头为真题/真题及解析，Z开头为解析
卷0/1/2/3分别表示合卷、卷一、卷二、卷三  

./CET6真题的配套听力/:  
以年份为文件夹，每文件夹下为听力mp3，相对路径与真题文件夹路径对应  

./官方要求/:  
含最新大纲pdf与简版考试内容图片

./模拟题/:
含听力、阅读模拟题、押题  

./其他资料/:
    ./其他资料/作文模板/
    ./其他资料/听力技巧/
    ./其他资料/经验分享/
    ./其他资料/词汇/
    ./其他资料/阅读资料/:阅读题目及美文

./Z-codes/:内容爬取并半自动化分类 实现代码
    ./Z-codes/Sele_getfiles.ipynb/:爬取内容
    ./Z-codes/split.ipynb:半自动化分类

./ReadMeCET6.md:本介绍文档  
```
### 二、代码
### **爬取内容**
#### 1.运行环境

+ python版本：3.9.18  
+ Module:
   + selenium(使用的Edge driver)
   + time
   + queue
   + pyperclip
   + os
   + subprocess
   + psutil
#### 2.基本思路
##### 2.1 由于该网站内容呈现目录化前端，各个内容的链接通过右击按钮能复制链接。故：  
+ 创建driver对象，使用driver逐级访问各级目录链接，获取其下目录链接存储入栈，不断循环出栈入栈操作，直到栈为空停止访问。
##### 2.2 考虑点：
###### 2.2.1  网站呈现目录形式，文件夹按钮左键点击后是进入下一级，而不是直接的下载链接；  
+ 文件按钮左键点击后是在该网站呈现该内容(汗...)，但二者通过右击按钮能复制链接：  
+ 通过右键点击的复制链接功能，存储所有链接。  
    - 如果链接中包含?的请求信息，则为下载文件链接，直接访问即可下载；
    - 反之，为下级目录链接，则继续访问，继续获取目录下链接。

###### 2.2.2 通过 **在Edge设置下载方式为直接下载无需确认** 来实现批量下载，但全部文件都下载在一个文件夹，非常杂乱；  
+ 要实现对网站上内容目录层次的复刻：  
    在逐次获取链接时，即通过os.path.join(parent_path,element.text)的方法迭代生成各文件、文件夹的路径名
1. 文件名内以“卷一”形式标记，文件目录不会按照一二三排序，可更名为卷1/2/3；  
1. 网站需要向下翻页加载剩余内容，需要搜集相关操作；  
1. 运行时，弹出的提示框挡住了控件，无法点击控件。



(设置edge_options是为使sele使用已有账户的信息运行浏览器)
##### 1.1
